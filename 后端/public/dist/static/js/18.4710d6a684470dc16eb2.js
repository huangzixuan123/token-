webpackJsonp([18],{UyKV:function(e,r){},WrGN:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=t("Xxa5"),l=t.n(o),s=t("exGp"),a=t.n(s),i=t("Dd8w"),n=t.n(i),u=t("NYxO"),m=t("gyMJ"),d={data:function(){return{fileList:[],dialogImageUrl:"",dialogVisible:!1,ruleForm:{short_name:"",goods_name:"",price:null,category:1},rules:{short_name:[{required:!0,message:"请输入商品名称",trigger:"blur"}],goods_name:[{required:!0,message:"请填写商品详情",trigger:"blur"}],price:[{required:!0,message:"请输入商品特价",trigger:"blur"}],category:[{required:!0,message:"请选择商品分类号",trigger:"blur"}]},options:[{value:1,label:"电子产品"},{value:2,label:"服饰箱包"},{value:3,label:"书本"},{value:4,label:"其他"}]}},computed:n()({},Object(u.c)(["userInfo"])),methods:{handleChange:function(e,r){r.length>1&&(r=r.slice(-1)),this.fileList=r},handlePictureCardPreview:function(e){this.dialogImageUrl=e.url,this.dialogVisible=!0},submitForm:function(e){var r=this;return a()(l.a.mark(function t(){var o,s,a;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o=!1,r.$refs[e].validate(function(t){t&&(r.$refs[e].model.goods_id=Number(r.$refs[e].model.goods_id),r.$refs[e].model.counts=Number(r.$refs[e].model.counts),r.$refs[e].model.price=Number(r.$refs[e].model.price),o=!0)}),r.fileList.length||(o=!1),!o){t.next=19;break}return s=new FormData,r.$refs[e].model.goods_id&&s.append("goods_id",r.$refs[e].model.goods_id),s.append("short_name",r.$refs[e].model.short_name),s.append("goods_name",r.$refs[e].model.goods_name),s.append("counts",r.$refs[e].model.counts),s.append("price",r.$refs[e].model.price),s.append("sales_tip",r.$refs[e].model.sales_tip),s.append("category",r.$refs[e].model.category),s.append("goods_img",r.fileList[0].raw),s.append("publisher",r.userInfo.user_nickname),s.append("publisher_id",r.userInfo.id),t.next=17,Object(m.a)(s);case 17:200===(a=t.sent).success_code?(r.$message({type:"success",message:"添加成功"}),r.$router.replace("/")):500===a.success_code?r.$message({type:"info",message:"商品已存在"}):r.$message({type:"error",message:"添加失败"});case 19:case"end":return t.stop()}},t,r)}))()},resetForm:function(e){this.$refs[e].resetFields()}}},c={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{attrs:{id:"addgoods"}},[t("h3",[e._v("发布商品")]),e._v(" "),t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{staticStyle:{width:"500px"},attrs:{label:"商品名称",prop:"short_name"}},[t("el-input",{model:{value:e.ruleForm.short_name,callback:function(r){e.$set(e.ruleForm,"short_name",r)},expression:"ruleForm.short_name"}})],1),e._v(" "),t("el-form-item",{staticStyle:{width:"500px"},attrs:{label:"商品图片"}},[t("el-upload",{attrs:{"list-type":"picture-card","on-preview":e.handlePictureCardPreview,"on-change":e.handleChange,"auto-upload":!1,multiple:!1,"limit:1":"",action:"http://localhost:3000"}},[t("i",{staticClass:"el-icon-plus"})]),e._v(" "),t("el-dialog",{attrs:{visible:e.dialogVisible},on:{"update:visible":function(r){e.dialogVisible=r}}},[t("img",{attrs:{width:"100%",src:e.dialogImageUrl,alt:""}})])],1),e._v(" "),t("el-form-item",{staticStyle:{width:"250px"},attrs:{label:"商品价格",prop:"price"}},[t("el-input",{attrs:{type:"number"},model:{value:e.ruleForm.price,callback:function(r){e.$set(e.ruleForm,"price",r)},expression:"ruleForm.price"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"商品分类",prop:"category"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ruleForm.category,callback:function(r){e.$set(e.ruleForm,"category",r)},expression:"ruleForm.category"}},e._l(e.options,function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),t("el-form-item",{staticStyle:{width:"500px"},attrs:{label:"商品详情",prop:"goods_name"}},[t("el-input",{attrs:{type:"textarea",autosize:""},model:{value:e.ruleForm.goods_name,callback:function(r){e.$set(e.ruleForm,"goods_name",r)},expression:"ruleForm.goods_name"}})],1),e._v(" "),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.submitForm("ruleForm")}}},[e._v("立即发布")]),e._v(" "),t("el-button",{on:{click:function(r){return e.resetForm("ruleForm")}}},[e._v("重置")])],1)],1)],1)},staticRenderFns:[]};var p=t("VU/8")(d,c,!1,function(e){t("UyKV")},"data-v-1f13282c",null);r.default=p.exports}});
//# sourceMappingURL=18.4710d6a684470dc16eb2.js.map