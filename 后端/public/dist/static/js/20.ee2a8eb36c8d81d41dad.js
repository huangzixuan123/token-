webpackJsonp([20],{Fx8a:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=s("Xxa5"),i=s.n(o),a=s("exGp"),r=s.n(a),n=s("Dd8w"),d=s.n(n),c=s("gyMJ"),u=s("zL8q"),l=s("NYxO"),_=(s("DHvs"),{data:function(){return{textarea:"",rating:0,colors:["#99A9BF","#F7BA2A","#FF9900"],currentGoodsId:0,shopNum:1}},computed:d()({},Object(l.c)(["goodsDetail","userInfo","goodsComment"])),created:function(){console.log(1),this.currentGoodsId=Number(this.$route.params.id),this.$store.dispatch("reqGoodsDetail",{goodsNo:this.currentGoodsId}),this.$store.dispatch("reqGoodsComment",{goodsId:this.currentGoodsId})},watch:{$route:function(){this.currentGoodsId=Number(this.$route.params.id),this.$store.dispatch("reqGoodsDetail",{goodsNo:this.currentGoodsId}),this.$store.dispatch("reqGoodsComment",{goodsId:this.currentGoodsId}),this.$store.dispatch("getUserInfo")}},methods:{post:function(){var e=this;return r()(i.a.mark(function t(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.textarea){t.next=3;break}return Object(u.MessageBox)({type:"info",message:"留言不得为空",showClose:!0}),t.abrupt("return");case 3:return t.next=5,Object(c.G)(e.goodsDetail[0].goods_id,e.textarea,e.userInfo.id,e.userInfo.user_nickname);case 5:200===t.sent.success_code?(Object(u.MessageBox)({type:"success",message:"发布成功",showClose:!0}),e.textarea="",e.$store.dispatch("reqGoodsComment",{goodsId:e.currentGoodsId})):Object(u.MessageBox)({type:"info",message:"发布失败",showClose:!0});case 7:case"end":return t.stop()}},t,e)}))()},dealWithCellBtnClick:function(e){var t=this;return r()(i.a.mark(function e(){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.userInfo.user_name?t.$confirm("确认购买吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){console;var e={user_id:t.userInfo.id,user_nickname:t.userInfo.user_nickname,publisher:t.goodsDetail[0].publisher,publisher_id:t.goodsDetail[0].publisher_id,goods_id:t.goodsDetail[0].goods_id};Object(c.d)(e).then(function(e){console.log(e),200===e.success_code?(t.$message.success("购买成功"),setTimeout(function(){t.$router.replace("/me/profile")},1e3)):t.$message.error(e.message)})}).catch(function(){}):Object(u.MessageBox)({type:"info",message:"请先登录!",showClose:!0});case 1:case"end":return e.stop()}},e,t)}))()},delComment:function(e){var t=this;this.$confirm("确定删除该留言吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(r()(i.a.mark(function s(){return i.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:Object(c.n)(e).then(function(e){200==e.success_code?(t.$message.success("删除成功"),t.$store.dispatch("reqGoodsComment",{goodsId:t.currentGoodsId})):t.$message.error("删除失败")});case 1:case"end":return s.stop()}},s,t)}))).catch(function(){})}}}),m={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.goodsDetail[0]?s("div",{attrs:{id:"container"}},[s("div",{staticClass:"pro_detail"},[s("div",{staticClass:"pro_img"},[s("div",{staticClass:"tb_booth"},[s("img",{staticClass:"pro_middle_img",attrs:{width:"100",height:"100",src:e.goodsDetail[0].image_url}})])]),e._v(" "),s("div",{staticClass:"pro_meg"},[s("div",{staticClass:"pro_meg_hd"},[s("h1",[e._v("\n\t\t\t\t\t \t\t"+e._s(e.goodsDetail[0].short_name)+"\n\t\t\t\t\t\t")])]),e._v(" "),s("div",{staticClass:"pro_meg_price"},[s("dl",[s("dt",[e._v("价格")]),e._v(" "),s("dd",[s("div",{staticClass:"promo_price"},[s("span",{staticClass:"tm-price"},[e._v(e._s(e._f("moneyFormat")(e.goodsDetail[0].price/100)))])])])]),e._v(" "),s("dl",[s("dt",[e._v("商品描述")]),e._v(" "),s("dd",[e._v(e._s(e.goodsDetail[0].goods_name))])]),e._v(" "),s("dl",[s("dt",[e._v("发布人")]),e._v(" "),s("dd",[e._v(e._s(e.goodsDetail[0].publisher_id==e.userInfo.id?"本人":e.goodsDetail[0].publisher)),s("span",{staticClass:"a"},[e._v(e._s(1==e.goodsDetail[0].user_status?"已实名":"未实名"))])])]),e._v(" "),s("dl",[s("dt",[e._v("发布时间")]),e._v(" "),s("dd",[e._v(e._s(e.goodsDetail[0].createTime))])])]),e._v(" "),s("div",{staticClass:"pro_meg_console"},[s("div",{staticClass:"shopping_car"},[s("el-button",{directives:[{name:"show",rawName:"v-show",value:e.goodsDetail[0].publisher_id!==e.userInfo.id,expression:"goodsDetail[0].publisher_id !== userInfo.id"}],attrs:{type:"danger"},on:{click:function(t){return t.preventDefault(),e.dealWithCellBtnClick(e.goodsDetail[0])}}},[e._v("立即购买")])],1)])])]),e._v(" "),s("div",{staticClass:"pro_comment"},[s("h3",[e._v("全部留言")]),e._v(" "),0!==e.goodsComment.length?s("div",e._l(e.goodsComment,function(t,o){return s("div",{key:o,staticClass:"media"},[s("div",{staticClass:"media-body"},[s("h6",{staticClass:"media-heading"},[e._v("用户: "),t.user_id==e.goodsDetail[0].publisher_id?s("span",[e._v("商家")]):s("span",[e._v(e._s(e._f("nameFormat")(t.user_nickname)))]),e.goodsDetail[0].publisher_id==e.userInfo.id||t.user_id==e.userInfo.id?s("span",{staticStyle:{float:"right",color:"#409eff","font-weight":"normal",cursor:"pointer"},on:{click:function(s){return e.delComment(t.comment_id)}}},[e._v("删除")]):e._e()]),e._v(" "),s("span",[e._v("留言:")]),e._v(" "+e._s(t.comment_detail)+"\n            ")])])}),0):s("div",{staticClass:"media"},[s("div",{staticClass:"media-body"},[e._v("\n            暂无留言\n          ")])])]),e._v(" "),e.userInfo.user_nickname?s("div",{staticClass:"pro_judge"},[s("h3",[e._v("留言")]),e._v(" "),s("el-input",{attrs:{type:"textarea",autosize:"",placeholder:"请输入内容"},model:{value:e.textarea,callback:function(t){e.textarea=t},expression:"textarea"}}),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.post()}}},[e._v("发布"),s("i",{staticClass:"el-icon-edit el-icon--right"})])],1):s("div",{staticClass:"pro_judge"},[s("h3",[e._v("评价该商品")]),e._v(" "),s("span",{staticClass:"judge_erro_tip"},[e._v("登录后才可发表评论")])])]):e._e()},staticRenderFns:[]};var p=s("VU/8")(_,m,!1,function(e){s("u3cr")},"data-v-080227ca",null);t.default=p.exports},u3cr:function(e,t){}});
//# sourceMappingURL=20.ee2a8eb36c8d81d41dad.js.map